# Denegar acceso a archivos sensibles
<Files ".env">
    Order allow,deny
    Deny from all
</Files>

<Files "config.php">
    Order allow,deny
    Deny from all
</Files>

# Headers de seguridad
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "DENY"
Header set X-XSS-Protection "1; mode=block"

# CORS - El usuario deberá especificar el ID de su extensión
# Reemplazar [ID_DE_LA_EXTENSION] con el ID real de la extensión
# Header set Access-Control-Allow-Origin "chrome-extension://[ID_DE_LA_EXTENSION]"
# Por ahora permitimos * para pruebas iniciales si es necesario, pero mejor dejarlo comentado para que el usuario lo configure
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "POST, OPTIONS"
Header set Access-Control-Allow-Headers "Content-Type"

# Manejar preflight requests
RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

